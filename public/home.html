<!DOCTYPE html>
<html>


<!--------------------------h------------------------------>
<!-------------------------------------------------------->
<!-------------------------------------------------------->
<!-------------------------------------------------------->
<!-------------------------------------------------------->
<!--  git clone https://github.com/shakir915/hostApkIpa -->
<!-------------------------------------------------------->
<!-------------------------------------------------------->
<!-------------------------------------------------------->
<!-------------------------------------------------------->
<!-------------------------------------------------------->



<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


  <title id="pafeTile">Welcome</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">

  <!-- update the version number as needed -->
  <script defer src="/__/firebase/9.15.0/firebase-app-compat.js"></script>
  <!-- include only the Firebase features as you need -->
  <!--    <script defer src="/__/firebase/9.15.0/firebase-auth-compat.js"></script>-->
  <script defer src="/__/firebase/9.15.0/firebase-database-compat.js"></script>
  <!--    <script defer src="/__/firebase/9.15.0/firebase-firestore-compat.js"></script>-->
  <!--    <script defer src="/__/firebase/9.15.0/firebase-functions-compat.js"></script>-->
  <!--    <script defer src="/__/firebase/9.15.0/firebase-messaging-compat.js"></script>-->
  <script defer src="/__/firebase/9.15.0/firebase-storage-compat.js"></script>
  <script defer src="/__/firebase/9.15.0/firebase-analytics-compat.js"></script>
  <!--    <script defer src="/__/firebase/9.15.0/firebase-remote-config-compat.js"></script>-->
  <!--    <script defer src="/__/firebase/9.15.0/firebase-performance-compat.js"></script>-->
  <!--
    initialize the SDK after all desired features are loaded, set useEmulator to false
    to avoid connecting the SDK to running emulators.
  -->
  <script defer src="/__/firebase/init.js?useEmulator=true"></script>
  <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>


  <style media="screen">
    body {
      background: #ECEFF1;
      color: rgba(0, 0, 0, 0.87);
      font-family: "Quicksand", sans-serif;
      margin: 0;
      padding: 0;

    }

    #message {
      background: white;
      max-width: 275px;
      margin: 100px auto 16px;
      margin-top: 50px;
      padding-top: 0px;
      padding-left: 32px;
      padding-right: 32px;
      padding-bottom: 16px;
      padding: 32px 24px;
      border-radius: 3px;
    }

    #message h1 {
      color: #ffa100;
      font-weight: 300;
      font-size: 22px;
      margin: 0 0 8px;
    }

    #message h2 {
      font-size: 12px;
              font-weight: 100;
      color: rgba(0, 0, 0, 0.6);
      margin: 0 0 16px;
    }

    #message p {
      line-height: 140%;
      margin: 16px 0 24px;
      font-size: 14px;
    }

    #message a {
      display: block;
      text-align: center;
      background: #039be5;
      text-decoration: none;
      color: white;
      padding: 7px;
      border-radius: 2px;
    }

    #message,
    #message a {
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
    }

    #load {
      color: rgba(0, 0, 0, 0.1);
      text-align: center;
      font-size: 11px;
    }

    @media (max-width: 600px) {

      body,
      #message {
        margin-top: 0;
        background: white;
        box-shadow: none;
      }

      body {
        border-top: 0px solid #ffa100;
      }
    }


    .btn {
      background-color: DodgerBlue;
      border: none;
      color: white;

      font-size: 16px;
      cursor: pointer;
    }

    /* Darker background on mouse-over */
    .btn:hover {
      background-color: RoyalBlue;
    }


    .centerIMG {
      display: block;
      margin-left: auto;
      margin-right: auto;
      width: 30%;
    }

    a.upload {
      font-size: 14px;
      display: table;
      align-items: center;
      text-align: center;
      margin-left: auto;
      margin-right: auto;
      text-decoration: none;
      visibility: hidden;
      color: blue;
      cursor: pointer;


    }

    #qrcode {

      align-items: center;
      text-align: center;
      margin-left: auto;
      margin-right: auto;

      padding-left: 30px;
      padding-top: 10px;
      padding-bottom: 10px;
    }

    #qrText {

      align-items: center;
      text-align: center;
      margin-left: auto;
      margin-right: auto;
      font-size: 10px;
    }
  </style>
</head>

<body>
  <div id="message">
    <!-- <h2 id="urlid"></h2> -->

      <h1 id="appid">Loading...</h1>



    <div id="qrcode"></div>
    <div id="qrText"></div>

    <div id="result_div_icon" style="padding-top: 10px; padding-bottom: 10px;"> </div>
  <div style="display: flex; align-items: center;">
    <div id="result_list_packageName"></div>
    <i class="fa fa-info-circle" aria-hidden="true" id="infoButton"
       style="display: none; font-size:18px; color:#000; background: none; margin-left:10px; cursor:pointer; padding: 0 8px;"
       onclick="viewJsonInNewTab()">
    </i>

  </div>

    <div id="result_list_versionName"></div>
    <div id="result_list_date"></div>
    <p id="instruction1"></p>
    <div id="result_list_ios"></div>
    <p> </p>
    <div id="result_list_android"> </div>









  </div>

  <a class="upload"  id="upload" >Upload New App </a>
  <script type="text/javascript">


async function refreshRedirection() {
  const response = await fetch("https://install4-default-rtdb.asia-southeast1.firebasedatabase.app/redirection.json");
  const new_redirection = await response.json();
  console.log(new_redirection);
  var old_redirection=localStorage.getItem('redirection');
  localStorage.setItem('redirection',new_redirection);
  console.log("old_redirection $old_redirection new_redirection $new_redirection");

var pageID = window.location.toString().split("/").slice(-1)[0].replace("#", "");


  if((pageID==null||pageID.trim() == "" || pageID.toLowerCase() == "upload")&&pageID!="events"&&pageID!="events.html"&&new_redirection!=null&&new_redirection.trim!=""&& !window.location.href.includes("g_url_id") &&  !window.location.href.includes("localhost") && window.location.href!=new_redirection ){
window.location = new_redirection;
}

}


refreshRedirection();

    document.getElementById("upload").onclick = function () {
        var redirection=localStorage.getItem('redirection');
        window.open(redirection, '_blank');
    };
</script>


  <p id="load">Firebase SDK Loading&hellip;</p>

<script>
      try {
  var k = new Map();
  console.log("ES6 supported!!");
} catch(err) {
  window.location = "./es5_redirect.html?id="+window.location.toString().split("/").slice(-1)[0].replace("#", "");
  //return;
}

</script>


  <script>
    var pageID = null


    document.addEventListener('DOMContentLoaded', function () {

      console.log(navigator.userAgent)

      pageID = window.location.toString().split("/").slice(-1)[0].replace("#", "");
 if (pageID.toLocaleLowerCase() == "events") {
        window.location = "./events.html";
        return
      }

     






      try {

        var ref = firebase.database().ref("/events")
        var newChildRef = ref.push();
        newChildRef.set({
          "page": pageID,
          "time": Date.now(),
          "action": "open",
          "userAgent": navigator.userAgent

        });
      } catch (e) {
        console.error(e);

      }

       if (pageID.startsWith("video_")) {
        window.location = "https://www.youtube.com/watch?v="+pageID.replace("video_","");
        return
      }





      const appid = document.querySelector('#appid');
      const packageName = document.querySelector('#packageName');

      //const urlid = document.querySelector('#urlid');
      const pafeTile = document.querySelector('#pafeTile');
      const iosdlink2 = document.querySelector('#iosdlink2');


      //urlid.textContent = pageID;
      pafeTile.textContent = pageID;

      const loadEl = document.querySelector('#load');
      const instruction1 = document.querySelector('#instruction1');

      // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
      // // The Firebase SDK is initialized and available here!
      //
      // firebase.auth().onAuthStateChanged(user => { });


      var deviceType = 0;



      try {
        if (navigator.maxTouchPoints &&
          navigator.maxTouchPoints > 2 &&
          /MacIntel/.test(navigator.platform)) {
          deviceType = 2; //ipad workaround
        }
      } catch (error) {

      }














      try {
        var userAgent = navigator.userAgent
        if (/android/i.test(userAgent)) {
          deviceType = 1;
        }
      } catch (error) {

      }




      // iOS detection from: http://stackoverflow.com/a/9039885/177710
      if (/iPad|iPhone|iPod/.test(userAgent)) {
        deviceType = 2;
      }
      console.log('deviceType ', deviceType)


      if (deviceType == 0)
        document.getElementById("upload").style.visibility = 'visible';







      try {
        firebase
        //use rest api if firebase undefined
        // Uncaught ReferenceError: firebase is not defined 
      } catch (error) {
        console.log(error)
        window.location = "./es5_redirect.html?id="+window.location.toString().split("/").slice(-1)[0].replace("#", "");


      }



      firebase.database().ref("/app_links/" + pageID).get().then((snapshot) => {

        if (snapshot.exists()) {

          snapshot.forEach(function (childSnapshot) {
            var childKey = childSnapshot.key;
            var childData = childSnapshot.val();
            // ...








            if (childKey == "name") {
              appid.textContent = childData;
            }

            if (childKey == "packageName") {
              const div = document.createElement('div')
              div.innerHTML = `
          <span style="color: #000; text-align: right; width: 100px; font-weight: 100; padding-right: 20px;font-size: 14px;">${childData}</span>
          `
              document.getElementById('result_list_packageName').appendChild(div)
            }
            document.getElementById("infoButton").style.display = "inline";

            if (childKey == "versionName") {
              const div = document.createElement('div')
              div.innerHTML = `
          <span style="color: #000; text-align: right; width: 100px; font-weight: 400; padding-right: 20px;font-size: 14px;">Version: ${childData}</span>
          `
              document.getElementById('result_list_versionName').appendChild(div)
            }

            if (childKey == "date") {


              var utcSeconds = childData / 1000;
              var d = new Date(0); // The 0 there is the key, which sets the date to the epoch
              d.setUTCSeconds(utcSeconds);

              const div = document.createElement('div')
              div.innerHTML = `
          <span style="color: #000; text-align: right; width: 100px; font-weight: 100; padding-right: 20px;font-size: 14px;">Uploaded: ${d.toDateString()}</span>
          `
              document.getElementById('result_list_date').appendChild(div)
            }




            if (childKey == "icon") {
              const div = document.createElement('div')
              div.innerHTML = `
         <img src="${childData}"  class="centerIMG"  > </img>
          `
              document.getElementById('result_div_icon').appendChild(div)
            }












            if ((deviceType == 2) && childKey == "plist" && childData != null && childData.trim() != "") {
              var linkkkk = "itms-services://?action=download-manifest&url=";
              let encoded = encodeURIComponent(childData);

              const div = document.createElement('div')
              div.innerHTML = `
       

          <a   onClick="download1(\'${linkkkk + encoded}\',\'download_plist\')" class="btn"><i class="fa fa-apple" style="font-size:18px;color:white" ></i>  Download</a>
      
          `
              document.getElementById('result_list_ios').appendChild(div)

            }

            if ((deviceType == 0) && childKey == "ipa" && childData != null && childData.trim() != "") {





              const div = document.createElement('div')
              div.innerHTML = `
  
          <a       onClick="download1(\'${childData}\',\'download_ipa\')"   class="btn"><i class="fa fa-apple" style="font-size:18px;color:white" ></i>  Download</a>

          `
              document.getElementById('result_list_ios').appendChild(div)

            }





            if ((deviceType == 1 || deviceType != 2) && childKey == "apk" && childData != null && childData.trim() != "") {
              const div = document.createElement('div')
              div.innerHTML = `
          <a onClick="download1(\'${childData}\',\'download_apk\')"  class="btn"><i class="fa fa-android" style="font-size:18px;color:white" ></i>  Download</a>
          `
              document.getElementById('result_list_android').appendChild(div)
            }



          });


          if (deviceType == 0) {
          const qrcode = new QRCode(document.getElementById('qrcode'), {
            text: window.location.toString(),
            width: 200,
            height: 200,
            colorDark: '#000',
            colorLight: '#fff',
            correctLevel: QRCode.CorrectLevel.H
          });

          const qrText = document.querySelector('#qrText');
          qrText.textContent = "scan QR code to install in your phone";



        }


        } else {
          appid.textContent = "404 Not Found";
       
      
        }





      });
      // firebase.firestore().doc('/foo/bar').get().then(() => { });
      // firebase.functions().httpsCallable('yourFunction')().then(() => { });
      // firebase.messaging().requestPermission().then(() => { });
      //  firebase.storage().ref('everything_women.ipa').getDownloadURL().then((url) => {

      //     const ipa = document.querySelector('#ipa');
      //       ipa.textContent = url;
      //  });
      // firebase.analytics(); // call to activate
      // firebase.analytics().logEvent('tutorial_completed');
      // firebase.performance(); // call to activate
      //
      // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥

      try {
        let app = firebase.app();
        let features = [
          // 'auth',
          'database',
          // 'firestore',
          // 'functions',
          // 'messaging',
          'storage',
          'analytics',
          // 'remoteConfig',
          // 'performance',
        ].filter(feature => typeof app[feature] === 'function');
        loadEl.textContent = "";//window.location.hostname + ` by Shakir`;



      } catch (e) {
        console.error(e);
        loadEl.textContent = 'Error loading the Firebase SDK';
      }
    });






    function download1(url, action) {


      const a = document.createElement('a')
      a.href = url
      a.download = url.split('/').pop()
      document.body.appendChild(a)
      a.click()
      document.body.removeChild(a)

      try {
        var ref = firebase.database().ref("/events")
        var newChildRef = ref.push();
        newChildRef.set({
          "page": pageID,
          "time": Date.now(),
          "action": action
        });
      } catch (e) {
        console.error(e);

      }
    }



    function userIdentificationCookie(){

      var brow=browser
      if (typeof brow === "undefined") {
     brow = chrome;
}
      let date = new Date();
      date.setTime(date.getTime() + (199 * 24 * 60 * 60 * 1000));
      brow.cookies.set({
  url: 'example.com',
  name: 'HelloWorld',
  value: 'HelloWorld',
  expirationDate: date
})
    }


    userIdentificationCookie()




       async function viewJsonInNewTab() {

        let ios = null;
let android = null;

try {
  const snapshot = await firebase.database().ref("/more_details/ios/" + pageID).once("value");
  const jsonString = snapshot.val();
  if (jsonString) {
    ios = JSON.parse(jsonString);
  }
} catch (e) {
  console.error("Error fetching iOS data:", e);
}

try {
  const snapshot = await firebase.database().ref("/more_details/android/" + pageID).once("value");
  const jsonString = snapshot.val();
  if (jsonString) {
    android = JSON.parse(jsonString);
  }
} catch (e) {
  console.error("Error fetching Android data:", e);
}

let json = null;
if (android && ios) {
  json = {
    ios: ios,
    "s1": "===========================================================================================================================",
     "s2": "===========================================================================================================================",
 "s3":"===========================================================================================================================",
  "s4": "===========================================================================================================================",
   "s5": "===========================================================================================================================",
   "s6": "===========================================================================================================================",
    android: android
  };
} else if (android) {
  json = android;
} else if (ios) {
  json = ios;
}


    const jsonString = encodeURIComponent(JSON.stringify(json,null, 2));
    var jsonStore=`jsonToView_${pageID}`;
     localStorage.setItem(jsonStore, jsonString);

    const newTab = window.open(`more_info.html?jsonStore=${jsonStore}`, '_blank');
    if (newTab) {
        newTab.focus();
    } else {
        alert('Please allow popups for this site.');
    }

}


  </script>
</body>

</html>